// ==================== é…ç½®æ•°æ® ====================
const CONFIG = {
    // é¢˜ç›®æ•°æ® - 32é“é¢˜
    questions: [
        { id: 1, text: "é¢å¯¹æ–°äº‹ç‰©ï¼Œä½ çš„æ€åº¦æ˜¯ï¼Ÿ" },
        { id: 2, text: "ä½ é€šå¸¸å‡ ç‚¹å…¥ç¡ï¼Ÿ" },
        { id: 3, text: "é‡åˆ°å›°éš¾æ—¶ï¼Œä½ ä¼šï¼Ÿ" },
        { id: 4, text: "ä½ å¯¹æµè¡Œè¶‹åŠ¿çš„æ€åº¦æ˜¯ï¼Ÿ" },
        { id: 5, text: "å‘¨æœ«ä½ æ›´å–œæ¬¢ï¼Ÿ" },
        { id: 6, text: "ä½ å¯¹ç¤¾äº¤åª’ä½“çš„ä½¿ç”¨é¢‘ç‡ï¼Ÿ" },
        { id: 7, text: "å¬éŸ³ä¹æ—¶ï¼Œä½ åå¥½ï¼Ÿ" },
        { id: 8, text: "ä½ çš„æœ‹å‹åœˆé€šå¸¸ï¼Ÿ" },
        { id: 9, text: "é¢å¯¹äº‰æ‰§ï¼Œä½ å€¾å‘äºï¼Ÿ" },
        { id: 10, text: "ä½ çš„ç©¿è¡£é£æ ¼ï¼Ÿ" },
        { id: 11, text: "çœ‹ç”µå½±/å‰§æ—¶ï¼Œä½ å–œæ¬¢ï¼Ÿ" },
        { id: 12, text: "å¯¹äºè®¡åˆ’ï¼Œä½ è®¤ä¸ºï¼Ÿ" },
        { id: 13, text: "ä½ å¯¹ç§‘æŠ€äº§å“çš„æ€åº¦ï¼Ÿ" },
        { id: 14, text: "ä½ çš„é¥®é£Ÿä¹ æƒ¯ï¼Ÿ" },
        { id: 15, text: "é¢å¯¹æ‰¹è¯„ï¼Œä½ ä¼šï¼Ÿ" },
        { id: 16, text: "ä½ çš„é˜…è¯»ä¹ æƒ¯ï¼Ÿ" },
        { id: 17, text: "æ—…è¡Œæ—¶ï¼Œä½ æ›´å–œæ¬¢ï¼Ÿ" },
        { id: 18, text: "ä½ å¯¹æ€€æ—§çš„æ€åº¦ï¼Ÿ" },
        { id: 19, text: "å·¥ä½œ/å­¦ä¹ æ—¶ï¼Œä½ ï¼Ÿ" },
        { id: 20, text: "ä½ çš„æ¶ˆè´¹è§‚å¿µï¼Ÿ" },
        { id: 21, text: "é¢å¯¹å˜åŒ–ï¼Œä½ ï¼Ÿ" },
        { id: 22, text: "ä½ çš„ä½œæ¯è§„å¾‹ï¼Ÿ" },
        { id: 23, text: "å¯¹å¾…å¥åº·ï¼Œä½ ï¼Ÿ" },
        { id: 24, text: "ä½ çš„å…´è¶£çˆ±å¥½ï¼Ÿ" },
        { id: 25, text: "é¢å¯¹å‹åŠ›ï¼Œä½ ï¼Ÿ" },
        { id: 26, text: "ä½ çš„å­¦ä¹ æ€åº¦ï¼Ÿ" },
        { id: 27, text: "å¯¹äºä¼ ç»Ÿï¼Œä½ ï¼Ÿ" },
        { id: 28, text: "ä½ çš„æ²Ÿé€šæ–¹å¼ï¼Ÿ" },
        { id: 29, text: "é¢å¯¹å¤±è´¥ï¼Œä½ ï¼Ÿ" },
        { id: 30, text: "ä½ çš„äººç”Ÿæ€åº¦ï¼Ÿ" },
        { id: 31, text: "å¯¹äºæœªæ¥ï¼Œä½ ï¼Ÿ" },
        { id: 32, text: "ä½ è®¤ä¸ºå¹´é¾„æ˜¯ï¼Ÿ" }
    ],

    // é€‰é¡¹é…ç½® - 5ä¸ªé€‰é¡¹
    options: [
        { value: 5, label: 'A', text: 'å……æ»¡å¥½å¥‡ï¼Œè¿«ä¸åŠå¾…æƒ³å°è¯•' },
        { value: 4, label: 'B', text: 'è°¨æ…è§‚æœ›ï¼Œä½†æ„¿æ„æ¥å—' },
        { value: 3, label: 'C', text: 'æ— æ‰€è°“ï¼Œé¡ºå…¶è‡ªç„¶' },
        { value: 2, label: 'D', text: 'ä¿æŒæ€€ç–‘ï¼Œä¸å¤ªæ„Ÿå…´è¶£' },
        { value: 1, label: 'E', text: 'æŠ—æ‹’æ”¹å˜ï¼Œå–œæ¬¢ç†Ÿæ‚‰çš„' }
    ],

    // æ¯é¢˜çš„å¾—åˆ†æƒé‡ï¼ˆå¯æ ¹æ®é¢˜ç›®è°ƒæ•´ï¼‰
    questionWeights: {
        1: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        2: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        3: { A: -3, B: -2, C: 0, D: 2, E: 3 },
        4: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        5: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        6: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        7: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        8: { A: -3, B: -2, C: 0, D: 2, E: 3 },
        9: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        10: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        11: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        12: { A: -3, B: -2, C: 0, D: 2, E: 3 },
        13: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        14: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        15: { A: -3, B: -2, C: 0, D: 2, E: 3 },
        16: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        17: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        18: { A: -3, B: -2, C: 0, D: 2, E: 4 },
        19: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        20: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        21: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        22: { A: -3, B: -2, C: 0, D: 2, E: 3 },
        23: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        24: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        25: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        26: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        27: { A: -3, B: -2, C: 0, D: 2, E: 4 },
        28: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        29: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        30: { A: -4, B: -2, C: 0, D: 2, E: 4 },
        31: { A: -5, B: -3, C: 0, D: 3, E: 5 },
        32: { A: -4, B: -2, C: 0, D: 2, E: 4 }
    }
};

// ==================== å…¨å±€çŠ¶æ€ ====================
let currentQuestionIndex = 0;
let answers = {}; // å­˜å‚¨ç­”æ¡ˆ
let actualAge = 0; // å®é™…å¹´é¾„

// ==================== å·¥å…·å‡½æ•° ====================

// æ˜¾ç¤ºæŒ‡å®šé¡µé¢
function showPage(pageId) {
    document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
    });
    document.getElementById(pageId).classList.add('active');
}

// ç›‘å¬å¹´é¾„è¾“å…¥
document.getElementById('actualAge')?.addEventListener('input', function() {
    const age = parseInt(this.value);
    const startBtn = document.getElementById('startBtn');
    
    if (age >= 8 && age <= 100) {
        startBtn.disabled = false;
    } else {
        startBtn.disabled = true;
    }
});

// ==================== å¼€å§‹æµ‹è¯• ====================
function startTest() {
    actualAge = parseInt(document.getElementById('actualAge').value);

    if (!actualAge || actualAge < 8 || actualAge > 100) {
        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´é¾„ï¼ˆ8-100å²ï¼‰');
        return;
    }

    // é‡ç½®çŠ¶æ€
    currentQuestionIndex = 0;
    answers = {};

    // æ˜¾ç¤ºç­”é¢˜é¡µ
    showPage('quizPage');

    // æ¸²æŸ“ç¬¬ä¸€é¢˜
    renderQuestion();
}

// ==================== å¿«é€Ÿæµ‹è¯• ====================
function quickTest() {
    // éšæœºè®¾ç½®å®é™…å¹´é¾„ï¼ˆ18-65å²ä¹‹é—´ï¼‰
    actualAge = Math.floor(Math.random() * (65 - 18 + 1)) + 18;

    // é‡ç½®çŠ¶æ€
    currentQuestionIndex = 0;
    answers = {};

    // å®Œå…¨éšæœºé€‰æ‹©ç­”æ¡ˆï¼Œä¸å¼ºåˆ¶æ§åˆ¶å·®å¼‚
    CONFIG.questions.forEach(question => {
        // éšæœºé€‰æ‹©ä¸€ä¸ªé€‰é¡¹
        const randomIndex = Math.floor(Math.random() * CONFIG.options.length);
        const selectedOption = CONFIG.options[randomIndex];
        answers[question.id] = selectedOption.label;
    });

    // ç›´æ¥æ˜¾ç¤ºç»“æœ
    showResult();
}

// ==================== æ¸²æŸ“é¢˜ç›® ====================
function renderQuestion() {
    const question = CONFIG.questions[currentQuestionIndex];
    const totalQuestions = CONFIG.questions.length;
    const answered = Object.keys(answers).length;
    const remaining = totalQuestions - answered;
    const progress = Math.round((answered / totalQuestions) * 100);
    
    // æ›´æ–°è¿›åº¦ä¿¡æ¯
    document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
    document.getElementById('progressPercent').textContent = `${progress}%`;
    document.getElementById('progressFill').style.width = `${progress}%`;
    document.getElementById('remainingCount').textContent = remaining;
    
    // æ›´æ–°é¢˜ç›®æ–‡å­—
    document.getElementById('questionText').textContent = question.text;
    
    // æ¸²æŸ“é€‰é¡¹
    const optionsList = document.getElementById('optionsList');
    optionsList.innerHTML = '';
    
    CONFIG.options.forEach(option => {
        const li = document.createElement('li');
        li.className = 'option-item';
        
        const button = document.createElement('button');
        button.className = 'option-btn';
        button.onclick = () => selectOption(option.label);
        
        // å¦‚æœå·²ç»é€‰æ‹©è¿‡ï¼Œæ·»åŠ é€‰ä¸­æ ·å¼
        if (answers[question.id] === option.label) {
            button.classList.add('selected');
        }
        
        button.innerHTML = `
            <span class="option-label">${option.label}</span>
            <span class="option-text">${option.text}</span>
        `;
        
        li.appendChild(button);
        optionsList.appendChild(li);
    });
    
    // æ›´æ–°ä¸Šä¸€é¢˜æŒ‰é’®çŠ¶æ€
    document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
}

// ==================== é€‰æ‹©é€‰é¡¹ ====================
function selectOption(label) {
    const question = CONFIG.questions[currentQuestionIndex];
    
    // ä¿å­˜ç­”æ¡ˆ
    answers[question.id] = label;
    
    // ç­‰å¾…ä¸€å°æ®µæ—¶é—´ï¼Œè®©ç”¨æˆ·çœ‹åˆ°é€‰ä¸­æ•ˆæœ
    setTimeout(() => {
        // å¦‚æœæ˜¯æœ€åä¸€é¢˜ï¼Œæ˜¾ç¤ºç»“æœ
        if (currentQuestionIndex === CONFIG.questions.length - 1) {
            showResult();
        } else {
            // å¦åˆ™ï¼Œè¿›å…¥ä¸‹ä¸€é¢˜
            currentQuestionIndex++;
            renderQuestion();
        }
    }, 300);
}

// ==================== ä¸Šä¸€é¢˜ ====================
function prevQuestion() {
    if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        renderQuestion();
    }
}

// ==================== è®¡ç®—å¿ƒç†å¹´é¾„ ====================
function calculateMentalAge() {
    let totalScore = 0;
    
    // ç´¯åŠ æ‰€æœ‰é¢˜ç›®çš„å¾—åˆ†
    for (let questionId in answers) {
        const label = answers[questionId];
        const weight = CONFIG.questionWeights[questionId];
        if (weight && weight[label] !== undefined) {
            totalScore += weight[label];
        }
    }
    
    // æ ¹æ®æ€»åˆ†è®¡ç®—å¿ƒç†å¹´é¾„
    // æ€»åˆ†èŒƒå›´å¤§çº¦ï¼š-160 åˆ° +160
    // å¿ƒç†å¹´é¾„ = å®é™…å¹´é¾„ + (æ€»åˆ† / 4)
    let mentalAge = actualAge + Math.round(totalScore / 4);
    
    // é™åˆ¶åœ¨åˆç†èŒƒå›´å†…
    mentalAge = Math.max(8, Math.min(80, mentalAge));
    
    return mentalAge;
}

// ==================== æ˜¾ç¤ºç»“æœ ====================
function showResult() {
    const mentalAge = calculateMentalAge();
    const ageDiff = actualAge - mentalAge;

    // åˆ‡æ¢åˆ°ç»“æœé¡µ
    showPage('resultPage');

    // æ˜¾ç¤ºå¿ƒç†å¹´é¾„å’Œå®é™…å¹´é¾„
    document.getElementById('mentalAgeDisplay').textContent = `${mentalAge}å²`;
    document.getElementById('actualAgeDisplay').textContent = `${actualAge}å²`;

    // æ ¹æ®å¹´é¾„å·®å¼‚é€‰æ‹©è¡¨æƒ…
    let emoji = 'ğŸ¤”'; // é»˜è®¤è¡¨æƒ…
    if (ageDiff > 15) {
        emoji = 'ğŸ˜„'; // éå¸¸å¹´è½»
    } else if (ageDiff > 8) {
        emoji = 'ğŸ˜Š'; // æ¯”è¾ƒå¹´è½»
    } else if (ageDiff > 3) {
        emoji = 'ğŸ™‚'; // ç¨å¾®å¹´è½»
    } else if (ageDiff >= -3) {
        emoji = 'ğŸ˜'; // åŸºæœ¬ä¸€è‡´
    } else if (ageDiff >= -8) {
        emoji = 'ğŸ¤”'; // ç¨å¾®æˆç†Ÿ
    } else if (ageDiff >= -15) {
        emoji = 'ğŸ˜”'; // æ¯”è¾ƒæˆç†Ÿ
    } else {
        emoji = 'ğŸ˜°'; // éå¸¸æˆç†Ÿ
    }
    document.querySelector('.emoji-icon').textContent = emoji;

    // è®¾ç½®å¹´é¾„å·®æ–‡å­—(å¸¦é«˜äº®æ•°å­—)
    const ageDiffText = document.getElementById('ageDifferenceText');
    const absDiff = Math.abs(ageDiff);
    if (ageDiff > 0) {
        ageDiffText.innerHTML = `æ‚¨çš„å¿ƒç†å¹´é¾„å¹´è½»<span class="age-diff-number">${absDiff}</span>å²`;
    } else if (ageDiff < 0) {
        ageDiffText.innerHTML = `æ‚¨çš„å¿ƒç†å¹´é¾„å¹´é•¿<span class="age-diff-number">${absDiff}</span>å²`;
    } else {
        ageDiffText.innerHTML = 'æ‚¨çš„å¿ƒç†å¹´é¾„ä¸å®é™…å¹´é¾„<span class="age-diff-number">ä¸€è‡´</span>';
    }

    // ==================== å¿ƒç†å¹´é¾„æ®µåˆ†æå’Œå»ºè®®ç”Ÿæˆ ====================
    function generateAgeAnalysis(age) {
        if (age <= 15) {
            return {
                analysis: 'æ‚¨çš„å¿ƒç†å¹´é¾„åå¹´è½»åŒ–ï¼Œçœ‹å¾…ä¸–ç•Œä»å¸¦ç€çº¯ç²¹ä¸ç›´æ¥ã€‚å¯¹æ–°é²œäº‹ç‰©å……æ»¡å¤©ç„¶çš„å¥½å¥‡å¿ƒï¼Œæƒ…ç»ªè¡¨è¾¾ç›´ç™½ä¸æ©é¥°ï¼Œå¼€å¿ƒæ—¶ä¼šå°½æƒ…å±•éœ²ï¼Œé‡åˆ°å§”å±ˆä¹Ÿå®¹æ˜“ç›´æ¥æµéœ²ã€‚å†…å¿ƒæ›´ä¾èµ–èº«è¾¹äººçš„é™ªä¼´ä¸æŒ‡å¼•ï¼Œåšå†³å®šæ—¶å€¾å‘äºå‚è€ƒä»–äººæ„è§ï¼Œå°šæœªå½¢æˆç‹¬ç«‹çš„åˆ¤æ–­ä½“ç³»ï¼Œå¯¹ç”Ÿæ´»çš„è®¤çŸ¥è¿˜å¤„åœ¨ç®€å•ã€æ— å‹åŠ›çš„é˜¶æ®µã€‚',
                suggestion: 'â€¢ ä¸ç”¨æ€¥äºå¼ºè¿«è‡ªå·±"å˜å¾—æˆç†Ÿ"ï¼Œäº«å—å½“ä¸‹çº¯ç²¹çš„çŠ¶æ€ï¼Œå…è®¸è‡ªå·±ä¿ç•™å¤©çœŸçš„è§†è§’\nâ€¢ é‡åˆ°å›°æƒ‘æˆ–æƒ…ç»ªæ³¢åŠ¨æ—¶ï¼Œä¸»åŠ¨å’Œä¿¡ä»»çš„äººæ²Ÿé€šï¼Œä¸ç”¨ç‹¬è‡ªæ‰›ä¸‹å‹åŠ›\nâ€¢ å°è¯•åšä¸€äº›åŠ›æ‰€èƒ½åŠçš„å°äº‹ï¼ˆæ¯”å¦‚æ•´ç†è‡ªå·±çš„ç‰©å“ã€è§„åˆ’å‘¨æœ«è¡Œç¨‹ï¼‰ï¼Œæ…¢æ…¢åŸ¹å…»ç‹¬ç«‹æ„è¯†\nâ€¢ å¤šå‚ä¸é›†ä½“æ´»åŠ¨æˆ–å…´è¶£å°ç»„ï¼Œåœ¨ä¸äººäº’åŠ¨ä¸­å­¦ä¼šè¡¨è¾¾è‡ªå·±ã€ç†è§£ä»–äºº'
            };
        } else if (age <= 20) {
            return {
                analysis: 'æ‚¨çš„å¿ƒç†çŠ¶æ€æ­£å¤„äºæ¢ç´¢ä¸è¿·èŒ«å¹¶å­˜çš„é˜¶æ®µã€‚å¯¹ä¸–ç•Œå……æ»¡æ¢ç´¢æ¬²ï¼Œæ„¿æ„å°è¯•æ–°äº‹ç‰©ã€æ¥è§¦æ–°åœˆå­ï¼Œä¸ç•æƒ§æœªçŸ¥çš„æŒ‘æˆ˜ã€‚ä½†åŒæ—¶ï¼Œé¢å¯¹äººç”Ÿæ–¹å‘ã€è‡ªæˆ‘å®šä½ç­‰é—®é¢˜æ—¶ï¼Œå®¹æ˜“äº§ç”Ÿå›°æƒ‘å’Œæ‘‡æ‘†ï¼Œæƒ…ç»ªèµ·ä¼ç›¸å¯¹æ˜æ˜¾ï¼Œå¯èƒ½ä¼šå› ä¸ºä»–äººçš„è¯„ä»·è€Œå½±å“è‡ªæˆ‘åˆ¤æ–­ï¼Œå¤„äº‹æ–¹å¼è¿˜å¸¦ç€äº›è®¸é’æ¶©ï¼Œä¸å¤Ÿæˆç†Ÿã€‚',
                suggestion: 'â€¢ å¤§èƒ†å»å°è¯•æ„Ÿå…´è¶£çš„äº‹ï¼Œå“ªæ€•æš‚æ—¶çœ‹ä¸åˆ°ç»“æœï¼Œæ¢ç´¢çš„è¿‡ç¨‹æœ¬èº«å°±æ˜¯æˆé•¿\nâ€¢ ä¸å¿…è¿‡åˆ†åœ¨æ„ä»–äººçš„çœ‹æ³•ï¼Œå¤šå€¾å¬è‡ªå·±å†…å¿ƒçš„å£°éŸ³ï¼Œæ…¢æ…¢å»ºç«‹è‡ªæˆ‘è®¤åŒ\nâ€¢ é‡åˆ°é€‰æ‹©æ—¶ï¼Œè¯•ç€åˆ—å‡ºåˆ©å¼Šå†åšå†³å®šï¼ŒåŸ¹å…»ç†æ€§æ€è€ƒçš„ä¹ æƒ¯\nâ€¢ å­¦ä¼šç®¡ç†è‡ªå·±çš„æƒ…ç»ªï¼Œæ¯”å¦‚æƒ…ç»ªæ¿€åŠ¨æ—¶å…ˆå†·é™5åˆ†é’Ÿï¼Œå†åšå›åº”'
            };
        } else if (age <= 25) {
            return {
                analysis: 'æ‚¨çš„å¿ƒç†çŠ¶æ€é€æ¸èµ°å‘ç‹¬ç«‹ï¼Œå¼€å§‹æœ‰äº†æ˜ç¡®çš„è‡ªæˆ‘æ„è¯†ã€‚ä¸å†ç›²ç›®è·Ÿé£ä»–äººï¼Œå¯¹è‡ªå·±çš„å–œå¥½ã€ç›®æ ‡æœ‰äº†åˆæ­¥çš„æ¸…æ™°è®¤çŸ¥ï¼Œæ„¿æ„ä¸ºè‡ªå·±çš„é€‰æ‹©è´Ÿè´£ã€‚é¢å¯¹å·¥ä½œæˆ–å­¦ä¹ ä¸­çš„é—®é¢˜ï¼Œä¼šä¸»åŠ¨æƒ³åŠæ³•è§£å†³ï¼Œè€Œä¸æ˜¯ä¸€å‘³ä¾èµ–ä»–äººã€‚ä½†åœ¨å¤æ‚çš„äººé™…æˆ–çªå‘çŠ¶å†µé¢å‰ï¼Œä»å¯èƒ½æ˜¾å¾—ç»éªŒä¸è¶³ï¼Œå¶å°”ä¼šé™·å…¥çº ç»“ï¼Œåšäº‹è¿˜ä¸å¤Ÿæ²‰ç¨³ã€‚',
                suggestion: 'â€¢ å›´ç»•è‡ªå·±çš„æ ¸å¿ƒç›®æ ‡ï¼Œæœ‰é’ˆå¯¹æ€§åœ°æå‡èƒ½åŠ›ï¼Œé¿å…ç›²ç›®å°è¯•å¯¼è‡´ç²¾åŠ›åˆ†æ•£\nâ€¢ é‡åˆ°æ£˜æ‰‹é—®é¢˜æ—¶ï¼Œä¸å¦¨å‘æœ‰ç»éªŒçš„äººè¯·æ•™ï¼Œå€Ÿé‰´ä»–äººç»éªŒèƒ½å°‘èµ°å¼¯è·¯\nâ€¢ å­¦ä¼šæ¥çº³è‡ªå·±çš„ä¸å®Œç¾ï¼Œä¸ç”¨å› ä¸€æ¬¡å¤±è¯¯å°±å¦å®šè‡ªå·±ï¼ŒæŠŠæ¯ä¸€æ¬¡ç»å†éƒ½å½“ä½œç§¯ç´¯\nâ€¢ åˆç†è§„åˆ’æ—¶é—´ï¼Œå¹³è¡¡å·¥ä½œã€å­¦ä¹ ä¸ç”Ÿæ´»ï¼Œé¿å…è¿‡åº¦æ¶ˆè€—è‡ªå·±'
            };
        } else if (age <= 30) {
            return {
                analysis: 'æ‚¨çš„å¿ƒç†çŠ¶æ€è¶‹äºæˆç†Ÿï¼Œå¤„äº‹æ›´å…·æ¡ç†å’Œè§„åˆ’æ€§ã€‚å¯¹äººç”Ÿæœ‰äº†æ›´æ¸…æ™°çš„æ–¹å‘ï¼ŒçŸ¥é“è‡ªå·±æƒ³è¦ä»€ä¹ˆã€è¯¥æ”¾å¼ƒä»€ä¹ˆï¼Œç›®æ ‡æ„Ÿè¾ƒå¼ºã€‚é¢å¯¹å‹åŠ›å’ŒæŒ‘æˆ˜æ—¶ï¼Œèƒ½ä¿æŒåŸºæœ¬çš„å†·é™ï¼Œä¸ä¼šè½»æ˜“è¢«æƒ…ç»ªå·¦å³ï¼Œä¼šä¸»åŠ¨å¯»æ‰¾è§£å†³é—®é¢˜çš„æ–¹æ³•ã€‚è´£ä»»æ„Ÿæ˜æ˜¾å¢å¼ºï¼Œæ— è®ºæ˜¯å¯¹å·¥ä½œã€å®¶åº­è¿˜æ˜¯è‡ªå·±ï¼Œéƒ½èƒ½æ‰›èµ·åº”å°½çš„è´£ä»»ï¼Œäººé™…ç›¸å¤„ä¸­ä¹Ÿæ‡‚å¾—æŠŠæ¡åˆ†å¯¸ã€‚',
                suggestion: 'â€¢ åœ¨è¿½æ±‚ç›®æ ‡çš„åŒæ—¶ï¼Œåˆ«å¿½ç•¥äº†èº«å¿ƒçŠ¶æ€ï¼Œå®šæœŸç»™è‡ªå·±æ”¾æ¾çš„æ—¶é—´ï¼Œé¿å…è¿‡åº¦ç´§ç»·\nâ€¢ å­¦ä¼šé€‚å½“å–èˆï¼Œä¸å¿…äº‹äº‹è¿½æ±‚å®Œç¾ï¼ŒæŠŠç²¾åŠ›æ”¾åœ¨æ ¸å¿ƒäº‹é¡¹ä¸Š\nâ€¢ å¤šå’Œå®¶äººã€æœ‹å‹æ²Ÿé€šï¼Œç»´æŠ¤å¥½äº²å¯†å…³ç³»ï¼Œå®ƒä»¬æ˜¯æƒ…ç»ªçš„é‡è¦æ”¯æ’‘\nâ€¢ æŒç»­å­¦ä¹ æ–°æŠ€èƒ½ï¼Œä¿æŒæ€ç»´çš„çµæ´»æ€§ï¼Œé¿å…è¢«å›ºæœ‰è®¤çŸ¥å±€é™'
            };
        } else if (age <= 35) {
            return {
                analysis: 'æ‚¨çš„å¿ƒç†çŠ¶æ€æ²‰ç¨³åŠ¡å®ï¼Œåšäº‹ä¸¥è°¨å‘¨å…¨ã€‚ç»è¿‡å¤šå¹´çš„ç§¯ç´¯ï¼Œå·²ç»å…·å¤‡äº†è¾ƒå¼ºçš„é—®é¢˜è§£å†³èƒ½åŠ›ï¼Œé¢å¯¹å¤æ‚æƒ…å†µæ—¶ï¼Œèƒ½å¿«é€ŸæŠ“ä½æ ¸å¿ƒçŸ›ç›¾ï¼Œåšå‡ºç†æ€§åˆ¤æ–­ã€‚äººé™…ç›¸å¤„ä¸­æˆç†Ÿå¾—ä½“ï¼Œæ‡‚å¾—æ¢ä½æ€è€ƒï¼Œèƒ½å¦¥å–„å¤„ç†å„ç§å…³ç³»ï¼Œè®©äººæ„Ÿåˆ°å¯é ã€‚ä½†æœ‰æ—¶å¯èƒ½å› ä¸ºè¿‡äºè¿½æ±‚ç¨³å¦¥ï¼Œè€Œç¼ºä¹ä¸€äº›å†’é™©ç²¾ç¥ï¼Œå¶å°”ä¼šæ˜¾å¾—æœ‰äº›ä¿å®ˆã€‚',
                suggestion: 'â€¢ é€‚å½“ç»™è‡ªå·±ä¸€äº›"è¯•é”™ç©ºé—´"ï¼Œä¸å¿…äº‹äº‹éƒ½æ±‚ç¨³ï¼Œå¶å°”çš„çªç ´å¯èƒ½ä¼šå¸¦æ¥æ–°æœºé‡\nâ€¢ å­¦ä¼šé€‚å½“æˆæƒï¼Œä¸ç”¨äº‹äº‹äº²åŠ›äº²ä¸ºï¼Œç›¸ä¿¡ä»–äººçš„èƒ½åŠ›ï¼Œä¹Ÿç»™è‡ªå·±å‡è´Ÿ\nâ€¢ åœ¨ç†æ€§å¤„äº‹çš„åŒæ—¶ï¼Œå¤šå…³æ³¨è‡ªå·±çš„å†…å¿ƒæ„Ÿå—ï¼Œåˆ«è®©"è´£ä»»"ç»‘æ¶äº†ç”Ÿæ´»çš„æ¸©åº¦\nâ€¢ åŸ¹å…»ä¸€é¡¹èƒ½è®©è‡ªå·±å®Œå…¨æ”¾æ¾çš„çˆ±å¥½ï¼Œå¹³è¡¡å·¥ä½œä¸ç”Ÿæ´»çš„èŠ‚å¥'
            };
        } else if (age <= 40) {
            return {
                analysis: 'æ‚¨çš„å¿ƒç†çŠ¶æ€ä»å®¹é€šé€ï¼Œå·²ç»å½¢æˆäº†è‡ªå·±çš„å¤„äº‹åŸåˆ™å’Œäººç”Ÿæ€åº¦ã€‚ä¸å†æ‰§ç€äºè¡¨é¢çš„å¾—å¤±ï¼Œæ›´çœ‹é‡å†…å¿ƒçš„å¹³é™ä¸ç”Ÿæ´»çš„è´¨æ„Ÿã€‚é¢å¯¹ç”Ÿæ´»ä¸­çš„èµ·ä¼ï¼Œèƒ½ä»¥å¹³å’Œçš„å¿ƒæ€æ¥çº³ï¼Œä¸ä¼šè¿‡åº¦ç„¦è™‘æˆ–æŠ±æ€¨ã€‚ç»éªŒä¸°å¯Œï¼Œçœ‹é—®é¢˜é€šé€ï¼Œèƒ½ç»™èº«è¾¹äººæä¾›æœ‰ä»·å€¼çš„å»ºè®®ï¼Œæ˜¯ä»–äººçœ¼ä¸­çš„"å¯é åç›¾"ã€‚ä½†æœ‰æ—¶å¯èƒ½ä¼šå› ä¸ºç»éªŒå›ºåŒ–ï¼Œå¯¹æ–°äº‹ç‰©çš„æ¥å—åº¦å˜æ…¢ã€‚',
                suggestion: 'â€¢ ä¿æŒå¯¹æ–°äº‹ç‰©çš„å¥½å¥‡å¿ƒï¼Œä¸»åŠ¨äº†è§£æ–°é²œè¶‹åŠ¿ï¼Œé¿å…æ€ç»´åƒµåŒ–\nâ€¢ æŠŠè‡ªå·±çš„ç»éªŒå’Œæ™ºæ…§åˆ†äº«ç»™ä»–äººï¼Œåœ¨å¸®åŠ©åˆ«äººçš„è¿‡ç¨‹ä¸­è·å¾—æ–°çš„æˆå°±æ„Ÿ\nâ€¢ æ³¨é‡èº«å¿ƒå¥åº·ï¼Œå…»æˆè§„å¾‹çš„ä½œæ¯å’Œè¿åŠ¨ä¹ æƒ¯ï¼Œä¸ºé•¿è¿œç”Ÿæ´»æ‰“ä¸‹åŸºç¡€\nâ€¢ å¤šäº«å—å½“ä¸‹çš„ç”Ÿæ´»ï¼Œä¸å¿…ä¸ºæœªæ¥è¿‡åº¦æ‹…å¿§ï¼Œå­¦ä¼šåœ¨å¹³æ·¡ä¸­å¯»æ‰¾ä¹è¶£'
            };
        } else if (age <= 50) {
            return {
                analysis: 'æ‚¨çš„å¿ƒç†çŠ¶æ€è±è¾¾åŒ…å®¹ï¼Œå¯¹ç”Ÿæ´»çš„ç†è§£æ›´ä¸ºæ·±åˆ»ã€‚ç»å†äº†å²æœˆçš„æ²‰æ·€ï¼Œå·²ç»èƒ½å¦ç„¶é¢å¯¹äººç”Ÿçš„å„ç§å¢ƒé‡ï¼Œä¸çº ç»“äºè¿‡å¾€çš„é—æ†¾ï¼Œä¹Ÿä¸ç›²ç›®ç„¦è™‘æœªæ¥ã€‚å¾…äººæ¥ç‰©æ¸©å’ŒåŒ…å®¹ï¼Œæ‡‚å¾—å°Šé‡ä¸åŒçš„è§‚ç‚¹å’Œç”Ÿæ´»æ–¹å¼ï¼Œå¿ƒæ€å¹³å’Œï¼Œä¸æ˜“è¢«å¤–ç•Œçäº‹å¹²æ‰°ã€‚å†…å¿ƒè¶³å¤Ÿå¼ºå¤§ï¼Œèƒ½åœ¨ç‹¬å¤„ä¸­æ‰¾åˆ°å®‰å®ï¼Œä¹Ÿèƒ½åœ¨ä¸äººç›¸å¤„ä¸­ä¼ é€’æ¸©æš–ã€‚',
                suggestion: 'â€¢ ç»§ç»­ä¿æŒå¹³å’Œçš„å¿ƒæ€ï¼Œäº«å—å½“ä¸‹çš„ç”Ÿæ´»èŠ‚å¥ï¼Œä¸ç”¨åˆ»æ„è¿½æ±‚è¿‡å¤šçš„ç›®æ ‡\nâ€¢ å¤šå‚ä¸èƒ½è®©è‡ªå·±èº«å¿ƒæ„‰æ‚¦çš„æ´»åŠ¨ï¼Œæ¯”å¦‚å›­è‰ºã€ä¹¦æ³•ã€æ—…è¡Œç­‰ï¼Œä¸°å¯Œç²¾ç¥ç”Ÿæ´»\nâ€¢ åŠ å¼ºä¸å®¶äººçš„é™ªä¼´ï¼Œå°¤å…¶æ˜¯å’Œæ™šè¾ˆçš„äº¤æµï¼Œåœ¨ä»£é™…äº’åŠ¨ä¸­æ„Ÿå—ç”Ÿæ´»çš„æ´»åŠ›\nâ€¢ å¯ä»¥æ•´ç†è‡ªå·±çš„äººç”Ÿæ„Ÿæ‚Ÿï¼Œæ— è®ºæ˜¯åˆ†äº«ç»™ä»–äººï¼Œè¿˜æ˜¯ç•™ç»™è‡ªå·±å›å¿†ï¼Œéƒ½æ˜¯çè´µçš„è´¢å¯Œ'
            };
        } else if (age <= 60) {
            return {
                analysis: 'æ‚¨çš„å¿ƒç†çŠ¶æ€æ·¡ç„¶é€šé€ï¼Œå·²ç»è¾¾åˆ°äº†ç›¸å¯¹æˆç†Ÿçš„äººç”Ÿå¢ƒç•Œã€‚çœ‹é—®é¢˜ç›´æŒ‡æœ¬è´¨ï¼Œä¸å†è¢«è¡¨è±¡æ‰€è¿·æƒ‘ï¼Œåšäº‹ä¸ç–¾ä¸å¾ï¼Œå¼ å¼›æœ‰åº¦ã€‚å¯¹ååˆ©çœ‹å¾—æ›´ä¸ºæ·¡ç„¶ï¼Œæ›´æ³¨é‡å†…å¿ƒçš„å¯Œè¶³ä¸ç²¾ç¥çš„è‡ªç”±ã€‚å¾…äººçœŸè¯šå®½åšï¼Œè‡ªå¸¦ä¸€ç§è®©äººå®‰å¿ƒçš„æ°”åœºï¼Œèƒ½ä»¥å¹³å’Œçš„å¿ƒæ€åŒ–è§£çŸ›ç›¾ï¼Œä¼ é€’æ­£èƒ½é‡ã€‚ç”Ÿæ´»èŠ‚å¥ä»å®¹ï¼Œæ‡‚å¾—ä¸è‡ªå·±ã€ä¸ä¸–ç•Œå’Œå¹³ç›¸å¤„ã€‚',
                suggestion: 'â€¢ ä¿æŒä»å®¹çš„ç”Ÿæ´»èŠ‚å¥ï¼Œæ ¹æ®è‡ªèº«çŠ¶æ€å®‰æ’æ—¥å¸¸ï¼Œä¸å‹‰å¼ºè‡ªå·±åšè¶…å‡ºèƒ½åŠ›èŒƒå›´çš„äº‹\nâ€¢ å¤šå’Œå¿—åŒé“åˆçš„äººäº¤æµï¼Œä¸°å¯Œç²¾ç¥ç”Ÿæ´»ï¼Œä¿æŒå¿ƒæ€çš„å¹´è½»æ´»åŠ›\nâ€¢ æ³¨é‡å…»ç”Ÿä¿å¥ï¼Œé¥®é£Ÿã€ä½œæ¯è§„å¾‹ï¼Œé€‚åº¦è¿åŠ¨ï¼Œå®ˆæŠ¤å¥½èº«å¿ƒå¥åº·\nâ€¢ äº«å—è¿™ä»½å†ç»å²æœˆæ²‰æ·€çš„é€šé€ï¼Œéšå¿ƒè€Œæ´»ï¼Œæ„Ÿå—ç”Ÿæ´»æœ€æœ¬çœŸçš„ç¾å¥½'
            };
        } else {
            return {
                analysis: 'æ‚¨çš„å¿ƒç†çŠ¶æ€è¶…ç„¶å¹³å’Œï¼Œå¯¹äººç”Ÿæœ‰ç€æ·±åˆ»çš„æ´å¯Ÿä¸ä½“æ‚Ÿã€‚å·²ç»è¶…è¶Šäº†ä¸–ä¿—çš„å¾—å¤±è®¡è¾ƒï¼Œæ›´çœ‹é‡ç²¾ç¥å±‚é¢çš„å¯Œè¶³ä¸å®‰å®ã€‚å¾…äººå¤„äº‹å®½åšæ…ˆæ‚²ï¼Œèƒ½ä»¥åŒ…å®¹çš„å¿ƒæ€çœ‹å¾…ä¸–é—´ä¸‡ç‰©ï¼Œä¸è‹›æ±‚ã€ä¸çº ç»“ã€‚å†…å¿ƒå¹³é™è€Œå¼ºå¤§ï¼Œæ— è®ºé‡åˆ°ä½•ç§å¢ƒé‡ï¼Œéƒ½èƒ½ä¿æŒä»å®¹ä¸è¿«çš„çŠ¶æ€ï¼Œè‡ªå¸¦ä¸€ç§å®‰å®šäººå¿ƒçš„åŠ›é‡ï¼Œæ´»æˆäº†è‡ªå·±å†…å¿ƒçš„æ¨¡æ ·ã€‚',
                suggestion: 'â€¢ ç»§ç»­ä¿æŒè¿™ä»½è¶…ç„¶çš„å¿ƒæ€ï¼Œéšå¿ƒè€ŒåŠ¨ï¼Œä¸è¢«å¤–ç•Œçº·æ‰°æ‰€å½±å“\nâ€¢ å¯ä»¥å°†è‡ªå·±çš„äººç”Ÿæ™ºæ…§ä»¥åˆé€‚çš„æ–¹å¼ä¼ é€’å‡ºå»ï¼Œä¸ºä»–äººæä¾›æŒ‡å¼•ä¸æ¸©æš–\nâ€¢ ä¸“æ³¨äºèƒ½è®©è‡ªå·±å†…å¿ƒæ„‰æ‚¦çš„äº‹ï¼Œæ— è®ºæ˜¯ç‹¬å¤„å†¥æƒ³ï¼Œè¿˜æ˜¯ä¸äººé—²è°ˆï¼Œéƒ½äº«å—å½“ä¸‹\nâ€¢ ä¿æŒèº«å¿ƒçš„å’Œè°ç»Ÿä¸€ï¼Œå–„å¾…è‡ªå·±ï¼Œåœ¨å¹³å’Œä¸­å®‰äº«ç”Ÿæ´»çš„é¦ˆèµ '
            };
        }
    }

    // ==================== æ ¹æ®å¿ƒç†å¹´é¾„æ®µç”Ÿæˆæè¿°å’Œå»ºè®® ====================
    const ageAnalysis = generateAgeAnalysis(mentalAge);

    // æ›´æ–°å†…å®¹
    document.getElementById('resultDescription').textContent = ageAnalysis.analysis;
    document.getElementById('resultSuggestion').innerHTML = `
        <h4>ä¸ªæ€§åŒ–å»ºè®®</h4>
        <p>${ageAnalysis.suggestion}</p>
    `;
}

// ==================== é‡æ–°æµ‹è¯• ====================
function restartTest() {
    currentQuestionIndex = 0;
    answers = {};
    actualAge = 0;
    
    // æ¸…ç©ºè¾“å…¥
    document.getElementById('actualAge').value = '';
    document.getElementById('startBtn').disabled = true;
    
    // è¿”å›ä»‹ç»é¡µ
    showPage('introPage');
}

// ==================== å…¨å±€å˜é‡ ====================
let quickTestClickCount = 0;
let quickTestClickTimes = []; // è®°å½•ç‚¹å‡»æ—¶é—´æˆ³
const quickTestRequiredClicks = 5; // éœ€è¦çš„ç‚¹å‡»æ¬¡æ•°
const quickTestTimeWindow = 10000; // æ—¶é—´çª—å£(æ¯«ç§’): 10ç§’

// ==================== é¡µé¢åŠ è½½å®Œæˆ ====================
document.addEventListener('DOMContentLoaded', function() {
    console.log('å¿ƒç†å¹´é¾„æµ‹è¯•å·²åŠ è½½');
});

// ==================== å¿«é€Ÿæµ‹è¯•éšè—/æ˜¾ç¤ºåŠŸèƒ½ ====================
function toggleQuickTest() {
    const now = Date.now();

    // æ·»åŠ å½“å‰ç‚¹å‡»æ—¶é—´æˆ³
    quickTestClickTimes.push(now);

    // ç§»é™¤10ç§’ä¹‹å¤–çš„æ—§æ—¶é—´æˆ³
    quickTestClickTimes = quickTestClickTimes.filter(time => now - time < quickTestTimeWindow);

    // æ£€æŸ¥æ˜¯å¦åœ¨10ç§’å†…ç‚¹å‡»äº†5æ¬¡
    if (quickTestClickTimes.length >= quickTestRequiredClicks) {
        // æ˜¾ç¤ºå¿«é€Ÿæµ‹è¯•æŒ‰é’®
        document.getElementById('quickTestBtn').style.display = 'block';
        console.log(`å¿«é€Ÿæµ‹è¯•å·²æ¿€æ´»`);
    } else {
        // å‰4æ¬¡ç‚¹å‡»éšè—å¿«é€Ÿæµ‹è¯•æŒ‰é’®
        document.getElementById('quickTestBtn').style.display = 'none';
        console.log(`å¿«é€Ÿæµ‹è¯•æœªæ¿€æ´» (${quickTestTimeWindow / 1000}ç§’å†…ç‚¹å‡»${quickTestClickTimes.length}æ¬¡ï¼Œè¿˜éœ€ç‚¹å‡»${quickTestRequiredClicks - quickTestClickTimes.length}æ¬¡)`);
    }
}